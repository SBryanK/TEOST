# EdgeOne Security Pentest Guide

This guide helps you configure Tencent EdgeOne and validate protections using the EdgeOne Security Test Android app. It includes an expanded capability list, coverage mapping, OWASP Top 10 alignment, and step-by-step console configuration for each supported capability.

## 1) What this app can do

Implemented pentest types (from app engine):

- DoS/Network: HttpSpike, ConnectionFlood, TcpPortReachability, UdpReachability, BasicConnectivity
- WAF: SqlInjection, XssTest, PathTraversal, CustomRulesValidation, OversizedBody
- Bot: UserAgentAnomaly, CookieJsChallenge, WebCrawlerSimulation
- API Protection: AuthenticationTest, BruteForce, EnumerationIdor, SchemaInputValidation, BusinessLogicAbuse

**Note**: Total of 14 test types exposed in UI (19 model-defined, 16 engine functions)

Notes

- Some enum types exist but are not executed by the engine (e.g., CommandInjection, Log4ShellProbe, EdgeRateLimiting as a dedicated type). Rate limiting is validated via high-RPS tests and responses (429/403/Retry-After) rather than a separate executor.

## 2) Tencent EdgeOne security capabilities (expanded)

- DoS and traffic control (app-layer)

  1. DoS HTTP/Layer-7 flood protection
  2. DoS Layer-3/4 (network/transport) scrubbing
  3. Rate limiting per IP
  4. Rate limiting per session/cookie/fingerprint

- WAF managed rules and controls 5. SQL injection detection 6. XSS detection 7. Path traversal detection 8. Command/OS injection detection 9. Log4Shell and CVE signatures 10. SSRF detection 11. RFI/LFI detection 12. Insecure deserialization detection 13. XML/XXE detection 14. Oversized request body limits 15. Long query/URL rule 16. Obfuscation/encoding evasion handling 17. Custom rules (method/URI/param/header)

- Access control and identity at the edge 18. IP allow/deny 19. Geo/ASN-based access 20. UA/Referer/Header/Method constraints

- Bot management 21. JS/cookie challenge and CAPTCHA 22. UA anomaly and reputation 23. Crawler controls 24. Device fingerprint/behavioral analysis

- API protection (at edge/WAF) 25. Auth header validation (presence/format) 26. Brute-force mitigation for login 27. Enumeration/IDOR rate controls and patterns 28. Schema/input validation and content-type hygiene 29. Business-logic abuse throttling

- Transport and platform 30. TLS/HTTPS policies (HSTS, mTLS, ciphers) 31. HTTP security headers (CORS, CSP) 32. Origin protection (shielding, origin pulls) 33. HTTP/2–3 and QUIC hardening 34. Custom response pages for block/challenge 35. Security logging/analytics/alerts

Total capabilities listed: 35

## 3) Mapping: EdgeOne capability → App test → Status

- DoS HTTP L7 flood → HttpSpike, ConnectionFlood → Yes
- DoS L3/L4 → — → No (out of scope for client app)
- WAF SQLi → SqlInjection → Yes
- WAF XSS → XssTest → Yes
- WAF Path traversal → PathTraversal → Yes
- WAF Command/OS injection → — → No
- WAF Log4Shell/CVE → — → No (template payload exists; dedicated executor not present)
- WAF SSRF → — → No
- WAF RFI/LFI → — → No (partial LFI signals via PathTraversal only if surfaced)
- WAF Insecure deserialization → — → No
- WAF XML/XXE → — → No
- WAF Oversized body → OversizedBody → Yes
- WAF Long query → — → No
- WAF encoding/obfuscation → SqlInjection/XssTest (encoding modes) → Yes (basic)
- WAF custom rules → CustomRulesValidation (headers/method/URI) → Yes
- Rate limiting per IP → HttpSpike/ConnectionFlood (observe 429/403/Retry-After) → Yes
- Rate limiting per cookie/session → High-RPS with cookie headers → Partial
- Access control IP allow/deny → BasicConnectivity/CustomRulesValidation (expect 403) → Yes
- Access control Geo/ASN → — → No (single-IP client)
- Access control UA/Referer/Method → CustomRulesValidation → Yes
- Bot challenge/CAPTCHA → CookieJsChallenge → Yes (challenge presence)
- Bot UA anomaly → UserAgentAnomaly → Yes
- Bot crawler controls → WebCrawlerSimulation → Yes
- Bot device fingerprint/behavior → — → No
- API auth header validation → AuthenticationTest → Yes
- API brute force → BruteForce (+ rate limit rules) → Yes
- API enumeration/IDOR → EnumerationIdor → Yes
- API schema/input validation → SchemaInputValidation → Yes
- API business logic abuse → BusinessLogicAbuse → Yes
- TLS/HTTPS policies → — → No
- HTTP security headers (CORS/CSP) → — → No
- Origin protection → — → No
- HTTP/2–3 & QUIC hardening → — → No
- Custom response page → — → No (observable but not validated)
- Security logging/analytics/alerts → — → No

Coverage: 18/35 = 51.4%

## 4) OWASP Top 10 (2021) alignment

- A01 Broken Access Control → Partial (edge access rules: IP/UA/Referer/Method). App does not validate app-layer role/ACL logic.
- A02 Cryptographic Failures → No
- A03 Injection → Yes (SQLi, XSS payload paths)
- A04 Insecure Design → No
- A05 Security Misconfiguration → Partial (WAF/rate-limit misconfig can be inferred when payloads pass)
- A06 Vulnerable & Outdated Components → No
- A07 Identification & Authentication Failures → Partial (API auth header tests, brute-force + rate limits)
- A08 Software & Data Integrity Failures → No
- A09 Security Logging & Monitoring Failures → No
- A10 Server-Side Request Forgery (SSRF) → No (not implemented in engine)

## 5) Console configuration steps (per supported capability)

Use your EdgeOne zone/domain. Prefer starting with Log/Challenge before Block in production.

### DoS HTTP L7 flood

- Security → DoS/HTTP Flood (CC Protection)
- Create rule: Scope "/" or "/api/\*"; Threshold 50 requests/10s per IP; Action Block or Challenge; Ban time 60–120s
- Validate with app: run HttpSpike/ConnectionFlood and expect 403/Challenge or 429/Retry-After

### WAF SQL injection

- Security → WAF → Managed Rules → enable "SQL Injection"; Sensitivity Medium/High; Action Block
- (Optional) Scope: Path "/search" and Param "q"
- Validate with app: SqlInjection test; expect 403 and logged rule hit

### WAF XSS

- Security → WAF → Managed Rules → enable "Cross-Site Scripting (XSS)"; Action Block/Challenge
- Validate: XssTest payloads; expect block/challenge

### WAF Path traversal

- Security → WAF → Managed Rules → enable "Directory/Path Traversal"; Action Block
- Validate: PathTraversal (e.g., "/admin/../../etc/passwd"); expect 403

### WAF Oversized request body

- Security → WAF → Settings/Advanced → Request Body Inspection → Max body size (e.g., 256 KB); Action Block/413
- Scope: Path "/api/big"
- Validate: OversizedBody; expect 413 or 403

### WAF encoding/obfuscation evasion

- Security → WAF → Managed Rules → ensure URL-encoding/Base64 evasion handling is enabled (default in managed packs)
- Validate: SqlInjection/XssTest with EncodingMode URL_ENCODE/BASE64; expect block

### WAF custom rules (header/method/URI)

- Security → WAF → Custom Rules (or Rule Engine)
- Examples:
  - If User-Agent contains "curl" → Block
  - If Method = POST AND Path = "/protected" AND missing header "Authorization" → Block/Challenge
  - If Referer not in allowlist → Challenge
- Validate: CustomRulesValidation with header/method overrides

### Rate limiting (per IP / per cookie)

- Security → Rate Limiting (or WAF → Rate Limit Rules)
- Rule: Path "/api/\*"; Limit 10 requests / 10 seconds per IP; Action 429 with Retry-After 10s
- (Optional) Fingerprint: Cookie/session id when supported; limit per fingerprint
- Validate: HttpSpike/ConnectionFlood; expect 429/Retry-After; with cookie set, verify per-cookie effect (partial)

### Access control (IP/UA/Referer/Method)

- Security → Access Control (or WAF → Custom Rules)
- Examples:
  - Deny Source IP = your testing device (for verification)
  - Allow only GET on "/public", block POST
  - Require Referer domain allowlist
- Validate: BasicConnectivity/CustomRulesValidation; expect 403 where denied

### Bot management (challenge, UA anomaly, crawler)

- Security → Bot Management
- Mode: Medium/Strict; Actions: JS/Cookie challenge; CAPTCHA for high-risk UA (curl/python)
- Path scope: "/protected" or entire site
- Validate:
  - CookieJsChallenge → expect challenge page/403 and Set-Cookie
  - UserAgentAnomaly (curl/python) → expect block/challenge
  - WebCrawlerSimulation → verify crawl restrictions (403/robots handling)

### API protection (auth, brute force, enumeration, schema, business logic)

- Security → WAF/Rule Engine and Rate Limiting
- Auth required rule: If Path matches "/auth/\*" and missing/invalid Authorization → 401/403 (custom action)
- Brute force: "/auth/login" limit 5 attempts/60s per IP (and per username if supported)
- Enumeration: throttle "/api/object/\*" and add anomaly alerts
- Schema/input: restrict content-types; block oversized fields
- Business logic: throttle replay on state-changing endpoints; sequence validation via backend + edge rules
- Validate with app tests accordingly

## 6) How to run tests from the app

- Use the Test Wizard: Category → Type → Configure → Cart → Confirm → Execution
- For high-RPS tests, prefer controlled non-production windows. Only test domains you own and have authorization for.
- Use the provided JSON template at `app/template_security_test_config.json` to pre-seed plans.

## 7) Gaps and how to close them

- Add engine executors for CommandInjection, Log4ShellProbe, SSRF, XXE, LongQuery to improve WAF coverage
- Add TLS/header checks (HSTS, CSP, CORS) via HTTP response analysis
- Add device fingerprint simulation (where legally permissible) to validate advanced bot detections
- Multi-region test harness to validate Geo/ASN rules

## 8) Coverage summary

- EdgeOne capability coverage: 18/35 = 51.4%
- OWASP Top 10 coverage: A03 Yes; A01/A05/A07 Partial; others No

---

Last updated: 2025-09-15
